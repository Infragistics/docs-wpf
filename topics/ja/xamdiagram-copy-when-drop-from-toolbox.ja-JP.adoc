////
|metadata|
{
    "name": "xamdiagram-copy-when-drop-from-toolbox",
    "tags": ["Charting"],
    "controlName": ["xamDiagram"],
    "guid": "",
    "buildFlags": [],
    "createdOn": "2017-03-14T09:37:02.0484523Z"
}
|metadata|
////

= ツールボックスから項目をドロップ (xamDiagram)

== トピックの概要

=== 目的

このトピックは、ダイアグラム項目がツールボックスからダイアグラムのサーフェスにドロップされるときにコピーされる方法について説明します。

=== 前提条件

本トピックの理解を深めるために、以下のトピックを参照することをお勧めします。

[options="header", cols="a,a"]
|====
|トピック|目的

| link:xamdiagram-general-overview.html[xamDiagram の概要]
|このトピックでは、xamDiagram コントロールの概要を説明します。

| link:xamdiagram-configuring-the-toolbox.html[ツールボックスの構成 (xamDiagram)]
|このトピックでは、xamDiagram のダイアグラム ツールボックスを構成する方法について説明します。

|====


=== このトピックの内容

* <<Ref00001, 概要>>
* <<Ref00002, Content プロパティのコピーの回避>>
* <<Ref00003, 関連トピック>>

[[Ref00001]]
== 概要

ツールボックスから link:{ApiPlatform}controls.charts.xamdiagram{ApiVersion}~infragistics.controls.charts.diagramitem.html[DiagramItem] をドラッグしてダイアグラムのサーフェスへドロップまたはコピー/貼り付け操作した際に、コントロールはこの項目のコピーを作成します。更に以下の項目のプロパティがコピーされます。

* link:{ApiPlatform}controls.charts.xamdiagram{ApiVersion}~infragistics.controls.charts.diagramitem~dragdropdata.html[DragDropData] - このプロパティはシャローコピーを使用してコピーされます。この処理は同じオブジェクト インスタンスの参照コピーを作成します。

* link:{ApiPlatform}controls.charts.xamdiagram{ApiVersion}~infragistics.controls.charts.diagramitem~content.html[Content] - このプロパティはディープコピーを使用してコピーされます。この処理は `Activator.CreateInstance()` メソッドを利用してオブジェクトの複製を作成します。つまり、複製されたダイアグラム項目がプロパティ値自体のインスタンスを持つことになります。バインディングとイベント ハンドラーはコピーされないことに注意してください。

.注:
[NOTE]
====
ディープコピーによる複製処理はコントロールに不明なタイプを作成します。そのようなタイプのインスタンスは、パラメーターのないコンストラクターがある場合のみ作成できます。
====

[[Ref00002]]
== Content プロパティのコピーの回避

ダイアグラム項目の `Content` プロパティのディープコピーを無効にする必要がある場合があります。以下の手順に従ってください。

. `DiagramNode` または `DiagramConnection` から拡張するカスタム クラスを作成します。 
. `Clone` メソッドをオーバーライドします。
. 新しい `Clone` メソッドで `CloneDiagramNodeProperties` または `CloneDiagramConnectionProperties` メソッドをそれぞれ呼び出します。
. 最後の `boolean` 引数を false に設定します。

以下のコード例は、`DiagramNode` の `Content` プロパティのコピーを回避する方法です。

*C# の場合:*
[source, csharp]
----
public class CustomDiagramNode : DiagramNode
{
    public override DiagramItem Clone()
    {
        var newCustomDiagramNode = new CustomDiagramNode();
        CloneDiagramNodeProperties(this, newCustomDiagramNode, false);
        return newCustomDiagramNode;
    }
}
----

*VB の場合:*
[source, vb]
----
Public Class CustomDiagramNode
    Inherits DiagramNode
    Public Overrides Function Clone() As DiagramItem
        Dim newCustomDiagramNode = New CustomDiagramNode()
        CloneDiagramNodeProperties(Me, newCustomDiagramNode, False)
        Return newCustomDiagramNode
    End Function
End Class
----

[[Ref00003]]
== 関連トピック

このトピックに関連する追加情報については、以下のトピックを参照してください。

[options="header", cols="a,a"]
|====
|トピック|目的

| link:xamdiagram-user-interactions-configuration-overview.html[ユーザー インタラクションの構成の概要 (xamDiagram)]
|このトピックでは、xamDiagram コントロールで実行されるユーザー インタラクションのすべてのタスクの概要を説明します。

| link:xamdiagram-configuring-ui-elements-with-commands.html[xamDiagram コマンドを使用した UI 要素の構成]
|このトピックでは、xamDiagram が提供するコマンドを、メニューやボタンなどの UI 要素で使用する方法を説明します。

| link:xamdiagram-configuring-the-context-menu.html[コンテキスト メニューの構成 (xamDiagram)]
|このトピックでは、xamDiagram コントロールが提供するコンテキスト メニューを使用する方法を説明します。

| link:xamdiagram-configuring-the-mouse-tool-and-default-interaction.html[マウス ツールおよびデフォルトのドラッグ操作の構成 (xamDiagram)]
|このトピックでは、xamDiagram のマウス操作とツールを構成する方法を説明します。

| link:xamdiagram-configuring-keyboard-shortcuts.html[キーボード ショートカットの構成 (xamDiagram)]
|このトピックでは、xamDiagram コマンドに関連付けられたキーボード ショートカットを変更する方法について説明します。

| link:xamdiagram-configuring-undo-redo-operations.html[元に戻す / やり直し操作の構成 (xamDiagram)]
|このトピックでは、xamDiagram コントロールで元に戻す / やり直し操作を構成する方法を説明します。

| link:xamdiagram-configuring-restricting-user-interactions.html[ユーザー インタラクションの制限の構成 (xamDiagram)]
|このトピックは、xamDiagram コントロールで特定のユーザー インタラクションを制限する方法を説明します。
|====