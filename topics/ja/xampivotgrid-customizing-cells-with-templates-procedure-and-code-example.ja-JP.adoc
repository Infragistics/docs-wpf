////

|metadata|
{
    "name": "xampivotgrid-customizing-cells-with-templates-procedure-and-code-example",
    "controlName": ["xamPivotGrid"],
    "tags": ["Grids","How Do I","Layouts","Templating"],
    "guid": "485ba493-d81f-4701-8fe4-d7f1b3f0d212",  
    "buildFlags": [],
    "createdOn": "2016-05-25T18:21:58.2153285Z"
}
|metadata|
////

= テンプレートを使用したセルのカスタマイズ - 手順とコード例

== トピックの概要

=== 目的

このトピックでは、xamPivotGrid™ セルの内容にカスタム `DataTemplates` を適用することで、セルをカスタマイズする方法について、順を追って説明します。

=== 前提条件

以下の表に、このトピックを理解するための前提条件として求められるトピックをリストします。

[options="header", cols="a,a"]
|====
|トピック|目的

| link:xampivotgrid-understanding-xampivotgrid.html[xamPivotGrid の概要]
|このセクションは xamPivotGrid コントロールの主要機能について説明します。ここに記載されているトピックでは、アプリケーションで xamPivotGrid コントロールを効果的に使用する方法が説明されています。

| link:xampivotgrid-getting-started-with-xampivotgrid.html[xamPivotGrid を使用した作業の開始]
|このトピックでは、xamPivotGrid コントロールを使用して作業を開始する方法について説明するため、このコントロールを {PlatformName} アプリケーションに追加するための手順を順を追って説明しています。

| link:xampivotgrid-customizing-cells-with-templates-overview.html[テンプレートを使用したセルのカスタマイズの概要]
|xamPivotGrid コントロールを使用すると、データ セルと、ヘッダー列と行のセルにカスタム データ テンプレートを指定できます。このトピックはこの機能の概要です。

|====

=== 本トピックの内容

このトピックには次のセクションがあります。

* <<_Ref319953034, テンプレートを使用したセルのカスタマイズ >>

** <<_Ref319953039,概要>>
** <<_Ref319953041,プレビュー>>
** <<_Ref319953044,要件>>
** <<_Ref319953046,概要>>
** <<_Ref319953049,手順>>

* <<_Ref319953052, コード例: テンプレートを使用したセルのカスタマイズ >>

** <<_Ref319953058,説明>>
** <<_Ref319953064,コード>>

* <<_Ref319953066, 関連コンテンツ >>

[[_Ref319953034]]
== テンプレートを使用したセルのカスタマイズ

[[_Ref319953039]]

=== 概要

次の手順では、xamPivotGrid のセルのカスタマイズ機能を使用する方法について説明します。

[[_Ref319953041]]

=== プレビュー

以下のスクリーンショットは最終結果のプレビューです。

image::images/xamPivotGrid_Customizing_Cells_with_Templates_Procedure_and_Code_Example_1.png[]

[[_Ref319953044]]

=== 要件

手順を完了するためには、xamPivotGrid コントロールを使用する {PlatformName} アプリケーションが必要です。この例では link:salesdatasample.html[SalesDataSample] データ ソースを使用していますが、他のデータを扱うことができるようコード例を変更してかまいません。

[[_Ref319953046]]

=== 概要

このトピックでは、xamPivotGrid のデータ セルおよびヘッダー セル用のカスタム テンプレートを作成し適用する方法について順を追って説明します。以下に手順の概要を示します。

<<step_1, 1. `DataTemplates`  の作成  。 >>

<<step_2, 2.データ セル用のテンプレートの適用。 >>

<<step_3, 3.行と列のヘッダー用のテンプレートの適用。 >>

[[_Ref319953049]]

=== 手順

[start=1]
. DataTemplates を作成します。

まず、後でセルの内容に割り当てる `DataTemplates` を作成する必要があります。これらのテンプレートを xamPivotGrid で使用する場合、 *データ セルの*   *DataContext*  は、セルに表示する値が格納された *文字列です* 。 *ヘッダー セルの場合、データ コンテキストは*  *それぞれの行/列の*  *組です* 。

そのため、`DataTemplate` 中でセルの値を取得するには、単純なデータ コンテキスト バインディング `{Binding}` を行う必要があります。

データ テンプレートを、ページのリソース セクションか、ページからアクセス可能な別の `ResourceDictionary` に追加します。

[start=2]
. データ セルのテンプレートを適用します。

link:{ApiPlatform}controls.grids.xampivotgrid{ApiVersion}~infragistics.controls.grids.datacelltemplate_members.html[DataCellTemplate] を作成し、xamPivotGrid の link:{ApiPlatform}controls.grids.xampivotgrid{ApiVersion}~infragistics.controls.grids.xampivotgrid~datacelltemplates.html[DataCellTemplates] コレクションに追加します。

手順 1 で作成したテンプレートの中から 1 つを使用するには、`DataCellTemplate` オブジェクトを `DataCellTemplates` コレクションに追加し、その link:{ApiPlatform}controls.grids.xampivotgrid{ApiVersion}~infragistics.controls.grids.datacelltemplate~template.html[Template] プロパティを、適用する `DataTemplate` に設定する必要があります。

必要に応じていくつでも `DataCellTemplates` を指定できます。

[start=3]
. テンプレートを適用するセルを指定します。

これは、`DataCellTemplates` の残りのプロパティに値を設定することで実現されます。

* 列と行の階層を指定します。

* link:{ApiPlatform}controls.grids.xampivotgrid{ApiVersion}~infragistics.controls.grids.datacelltemplate~columnhierarchy.html[ColumnHierarchy] プロパティを設定した場合、データ テンプレートが、指定した列階層の中にあるすべてのデータ セルに適用されます。値は、対象にする link:{ApiPlatform}olap{ApiVersion}~infragistics.olap.data.base.hierarchy_members.html[Hierarchy] の link:{ApiPlatform}olap{ApiVersion}~infragistics.olap.data.base.hierarchy~caption.html[Caption] プロパティと同じであることが必要です。同様に、 link:{ApiPlatform}controls.grids.xampivotgrid{ApiVersion}~infragistics.controls.grids.datacelltemplate~rowhierarchy.html[RowHierarchy] プロパティの値を指定できます。これにより、列と行の両方の階層中のセルにテンプレートが適用されます。

* 列と行のレベルを指定します。

* これらのプロパティに値を設定すると、データ テンプレートの適用先を定義するより明確な条件を作成できます。`Level` に整数値を設定すると、テンプレートがそのレベルのセルのみに適用されます。レベル番号は 0 ではなく 1 で始まります。

* 列と行のラベルを指定します。

* これらのプロパティを設定すると、指定したラベルが設定されている列または行ヘッダーのセルのみにテンプレートが適用されます。これにより、カスタム `DataTemplate` を特定のセルに適用できます。

.注:
[NOTE]
====
これらのプロパティはすべてオプションですが、テンプレートが適用されるように少なくとも 1 つを設定する必要があります。一部または全部のプロパティが設定されている場合、プロパティの値がすべて一致するセルにテンプレートが適用されます。2 つ以上のテンプレートで競合がある場合、最も具体的なテンプレートが適用されます。一致するセルがない場合、テンプレートはまったく適用されません。
====

[start=4]
. 行と列のヘッダーのテンプレートを適用します。

link:{ApiPlatform}controls.grids.xampivotgrid{ApiVersion}~infragistics.controls.grids.headertemplate_members.html[HeaderTemplate] を作成し、 link:{ApiPlatform}controls.grids.xampivotgrid{ApiVersion}~infragistics.controls.grids.xampivotgrid~columnheadertemplates.html[ColumnHeaderTemplates]/ link:{ApiPlatform}controls.grids.xampivotgrid{ApiVersion}~infragistics.controls.grids.xampivotgrid~rowheadertemplates.html[RowHeaderTemplates] コレクションに追加します。

そのためには、`DataCellTemplates` を xamPivotGrid の `DataCellTemplates` コレクションに追加するのと同様の方法を使用します。

テンプレートを適用する列/行ヘッダー セルを指定します。

* 階層を指定します。

* すべての列/行ヘッダー セルにテンプレートを割り当てるには、`Hierarchy` プロパティを使用します。

* レベルを指定します。

* `Level` プロパティを設定すると、テンプレートが指定したレベルのセルに適用されます。`DataCellTemplate` と同様に、レベル番号は 1 で始まります。

* ラベルを指定します。

* これにより、列/行の`キャプション`が指定したものと同じであるヘッダー セルのみにテンプレートが適用されます。

[[_Ref319953052]]
== コード例: テンプレートを使用したセルのカスタマイズ

[[_Ref319953058]]

=== 説明

次の例は、カスタム `DataTemplates` を作成し、xamPivotGrid のデータ セルとヘッダー セルに適用する方法を示します。

[[_Ref319953064]]

=== コード

DataTemplates をページの Resources に追加します。

*XAML の場合:*

[source,xaml]
----
<UserControl.Resources>
    <DataTemplate x:Key="DataTemplate1">
        <TextBlock Foreground="Red" Text="{Binding}"/>
    </DataTemplate>
    <DataTemplate x:Key="DataTemplate2">
        <TextBlock Foreground="Green" Text="{Binding}"/>
    </DataTemplate>
    <DataTemplate x:Key="DataTemplate3">
        <Grid Background="LightGreen">
            <TextBlock Text="{Binding}"/>
        </Grid>
    </DataTemplate>
    <DataTemplate x:Key="DataTemplate4">
        <Grid Background="LightBlue">
            <TextBlock Text="{Binding}"/>
        </Grid>
    </DataTemplate>
</UserControl.Resources>
----

DataTemplates を適用します。

*XAML の場合:*

[source,xaml]
----
<ig:XamPivotGrid x:Name="pivotGrid"
                    DataSource="{StaticResource FlatDataSource}">
   <ig:XamPivotGrid.DataCellTemplates>
        <ig:DataCellTemplate Template="{StaticResource DataTemplate1}"
                              ColumnHierarchy="Product"
                              ColumnLabel="Clothing"/>
        <ig:DataCellTemplate Template="{StaticResource DataTemplate2}"
                             RowHierarchy="Seller"
                             RowLevel="2"
                             RowLabel="John Smith"/>
    </ig:XamPivotGrid.DataCellTemplates>
    <ig:XamPivotGrid.ColumnHeaderTemplates>
        <ig:HeaderTemplate Template="{StaticResource DataTemplate3}"
                            Label="Bikes"/>
    </ig:XamPivotGrid.ColumnHeaderTemplates>
    <ig:XamPivotGrid.RowHeaderTemplates>
        <ig:HeaderTemplate Template="{StaticResource DataTemplate4}"
                            Hierarchy="Seller"
                            Level="2"/>
    </ig:XamPivotGrid.RowHeaderTemplates>
</ig:XamPivotGrid>
----

*C# の場合:*

[source,csharp]
----
…
pivotGrid.DataCellTemplates.Add((DataCellTemplate)this.Resources["DataTemplate1"]);
            pivotGrid.DataCellTemplates.Add((DataCellTemplate)this.Resources["DataTemplate2"]);
            pivotGrid.ColumnHeaderTemplates.Add((HeaderTemplate)this.Resources["DataTemplate3"]);
            pivotGrid.RowHeaderTemplates.Add((HeaderTemplate)this.Resources["DataTemplate4"]);
…
----

*Visual Basic の場合:*

[source,vb]
----
pivotGrid.DataCellTemplates.Add(DirectCast(Me.Resources("DataTemplate1"), DataCellTemplate))
pivotGrid.DataCellTemplates.Add(DirectCast(Me.Resources("DataTemplate2"), DataCellTemplate))
pivotGrid.ColumnHeaderTemplates.Add(DirectCast(Me.Resources("DataTemplate3"), HeaderTemplate))
pivotGrid.RowHeaderTemplates.Add(DirectCast(Me.Resources("DataTemplate4"), HeaderTemplate))
----

[[_Ref319953066]]
== 関連コンテンツ

以下のトピックでは、このトピックに関連する情報を提供しています。

[options="header", cols="a,a"]
|====
|トピック|目的

| link:xampivotgrid-customizing-cells-with-templates-property-reference.html[テンプレートによるセルのカスタマイズのプロパティ参照]
|これは、xamPivotGrid のセル カスタマイズ機能に関連する最も注意すべきプロパティのリストです。

| link:xampivotgrid-us-conditional-formating.html[条件フォーマッティング]
|CellControlAttached イベントを使用し、セルの値に基づいてカスタム スタイルをデータ セルに適用する方法の説明です。

|====
